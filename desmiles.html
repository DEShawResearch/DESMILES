<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Usage &mdash; desmiles  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Release notes" href="release-notes.html" />
    <link rel="prev" title="desmiles" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> desmiles
          </a>
              <div class="version">
                BETA
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#finetuning-of-desmiles">Finetuning of desmiles</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#create-a-finetuned-model">Create a finetuned model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Named Arguments">Named Arguments</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#using-finetuned-model">Using finetuned model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Named Arguments">Named Arguments</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#additional-processing-of-results">Additional processing of results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#python-api">Python API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-desmiles.models">desmiles.models</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-desmiles.learner">desmiles.learner</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-desmiles.data">desmiles.data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-desmiles.decoding.astar">desmiles.decoding</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-desmiles.utils">desmiles.utils</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="release-notes.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="issues.html">Open issues</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">desmiles</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Usage</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/desmiles.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="usage">
<h1>Usage<a class="headerlink" href="#usage" title="Permalink to this headline"></a></h1>
<section id="finetuning-of-desmiles">
<h2>Finetuning of desmiles<a class="headerlink" href="#finetuning-of-desmiles" title="Permalink to this headline"></a></h2>
<section id="create-a-finetuned-model">
<h3>Create a finetuned model<a class="headerlink" href="#create-a-finetuned-model" title="Permalink to this headline"></a></h3>
<p>finetune_model.py will consume a CSV file of matched pairs and dump a learner that is finetuned to preferentially optimize the resulting molecules.  The typical CSV file has format: “SMILES_1, SMILES_2, similarity, delta_PI, P1, P2” with delta_PI the difference in the log10 of IC50 and delta_PI positive.  The code will only read the entries: “SMILES_1”, “SMILES_2”, and assume that all postprocessing to bring the CSV file to the correct format was done beforehand.  (FIXME: Share an example notebook that creates and inspects such a datasets of pairs from a single list of molecules with IC50 values.)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">finetune_model</span><span class="o">.</span><span class="n">py</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="o">-</span><span class="n">t</span> <span class="n">TRAINING_PAIRS</span> <span class="o">-</span><span class="n">l</span> <span class="n">LEARNER</span> <span class="p">[</span><span class="o">-</span><span class="n">e</span> <span class="n">NUM_EPOCHS</span><span class="p">]</span>
                         <span class="p">[</span><span class="o">-</span><span class="n">m</span> <span class="n">MAX_LR</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">d</span> <span class="n">DIV_FACTOR</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">b</span> <span class="n">BATCH_SIZE</span><span class="p">]</span>
                         <span class="p">[</span><span class="o">-</span><span class="n">v</span> <span class="n">TRUE_VALIDATION</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">s</span> <span class="n">START_VALIDATION</span><span class="p">]</span>
</pre></div>
</div>
<section id="Named Arguments">
<h4>Named Arguments<a class="headerlink" href="#Named Arguments" title="Permalink to this headline"></a></h4>
<dl class="option-list">
<dt><kbd>-t, --training_pairs</kbd></dt>
<dd><p>filename of the training pairs (csv with SMILES_1, SMILES_2)</p>
</dd>
<dt><kbd>-l, --learner</kbd></dt>
<dd><p>filename of the finetuned model</p>
</dd>
<dt><kbd>-e, --num_epochs</kbd></dt>
<dd><p>number of epochs (0 for none)</p>
<p>Default: 1</p>
</dd>
<dt><kbd>-m, --max_lr</kbd></dt>
<dd><p>maximal learning rate</p>
<p>Default: 0.001</p>
</dd>
<dt><kbd>-d, --div_factor</kbd></dt>
<dd><p>div factor in one-cycle training</p>
<p>Default: 7</p>
</dd>
<dt><kbd>-b, --batch_size</kbd></dt>
<dd><p>batch size</p>
<p>Default: 200</p>
</dd>
<dt><kbd>-v, --true_validation</kbd></dt>
<dd><p>dont train on validation subset</p>
<p>Default: False</p>
</dd>
<dt><kbd>-s, --start_validation</kbd></dt>
<dd><p>fraction of data at start of validation</p>
<p>Default: 0.8</p>
</dd>
</dl>
</section>
</section>
<section id="using-finetuned-model">
<h3>Using finetuned model<a class="headerlink" href="#using-finetuned-model" title="Permalink to this headline"></a></h3>
<p>read_saved_model.py will read the learner that was generated by finetuned_model and will apply it on a new set of small molecules.  The small molecules will first be converted to fingerprints and then regenerated in optimized versions using the finetuned model.  The parameter training_pairs (same as in finetune_model) is only used to separate novel molecules from those seen in the training set, if any such generated molecules exist.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">read_saved_model</span><span class="o">.</span><span class="n">py</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="o">-</span><span class="n">w</span> <span class="n">WORKDIR</span> <span class="o">-</span><span class="n">l</span> <span class="n">LEARNER</span> <span class="p">[</span><span class="o">-</span><span class="n">n</span> <span class="n">NUM_RETURN</span><span class="p">]</span>
                           <span class="p">[</span><span class="o">-</span><span class="n">m</span> <span class="n">NUM_MAX_TRY</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">x</span> <span class="n">NUM_EXPAND</span><span class="p">]</span> <span class="o">-</span><span class="n">i</span> <span class="n">INPUT_SMILES</span> <span class="o">-</span><span class="n">t</span>
                           <span class="n">TRAINING_PAIRS</span>
</pre></div>
</div>
<section id="Named Arguments">
<h4>Named Arguments<a class="headerlink" href="#Named Arguments" title="Permalink to this headline"></a></h4>
<dl class="option-list">
<dt><kbd>-w, --workdir</kbd></dt>
<dd><p>directory with output</p>
</dd>
<dt><kbd>-l, --learner</kbd></dt>
<dd><p>name of saved model</p>
</dd>
<dt><kbd>-n, --num_return</kbd></dt>
<dd><p>molecules to output for each input molecule</p>
<p>Default: 30</p>
</dd>
<dt><kbd>-m, --num_max_try</kbd></dt>
<dd><p>maximal number of astar iterations</p>
<p>Default: 1000</p>
</dd>
<dt><kbd>-x, --num_expand</kbd></dt>
<dd><p>batch expansions to try on GPU astar</p>
<p>Default: 1000</p>
</dd>
<dt><kbd>-i, --input_smiles</kbd></dt>
<dd><p>list of input smiles; no header</p>
</dd>
<dt><kbd>-t, --training_pairs</kbd></dt>
<dd><p>list of training molecules</p>
</dd>
</dl>
</section>
</section>
<section id="additional-processing-of-results">
<h3>Additional processing of results<a class="headerlink" href="#additional-processing-of-results" title="Permalink to this headline"></a></h3>
</section>
</section>
<section id="python-api">
<h2>Python API<a class="headerlink" href="#python-api" title="Permalink to this headline"></a></h2>
<section id="module-desmiles.models">
<span id="desmiles-models"></span><h3>desmiles.models<a class="headerlink" href="#module-desmiles.models" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="desmiles.models.Desmiles">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">desmiles.models.</span></span><span class="sig-name descname"><span class="pre">Desmiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">desmiles_rnn_core</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linear_decoder</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/models.html#Desmiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.models.Desmiles" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Combines DesmilesCore with LinearDecoder for a full model</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(*input, **kwargs)</p></td>
<td><p>Call self as a function.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_module</span></code>(name, module)</p></td>
<td><p>Adds a child module to the current module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply</span></code>(fn)</p></td>
<td><p>Applies <code class="docutils literal notranslate"><span class="pre">fn</span></code> recursively to every submodule (as returned by <code class="docutils literal notranslate"><span class="pre">.children()</span></code>) as well as self.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">buffers</span></code>([recurse])</p></td>
<td><p>Returns an iterator over module buffers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">children</span></code>()</p></td>
<td><p>Returns an iterator over immediate children modules.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cpu</span></code>()</p></td>
<td><p>Moves all model parameters and buffers to the CPU.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cuda</span></code>([device])</p></td>
<td><p>Moves all model parameters and buffers to the GPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">double</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">double</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval</span></code>()</p></td>
<td><p>Sets the module in evaluation mode.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">extra_repr</span></code>()</p></td>
<td><p>Set the extra representation of the module</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to float datatype.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#desmiles.models.Desmiles.forward" title="desmiles.models.Desmiles.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(input_seq, input_fp, lengths)</p></td>
<td><p>Defines the computation performed at every call.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">half</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">half</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_state_dict</span></code>(state_dict[, strict])</p></td>
<td><p>Copies parameters and buffers from <code class="xref py py-attr docutils literal notranslate"><span class="pre">state_dict</span></code> into this module and its descendants.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">modules</span></code>()</p></td>
<td><p>Returns an iterator over all modules in the network.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_buffers</span></code>([prefix, recurse])</p></td>
<td><p>Returns an iterator over module buffers, yielding both the name of the buffer as well as the buffer itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_children</span></code>()</p></td>
<td><p>Returns an iterator over immediate children modules, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_modules</span></code>([memo, prefix])</p></td>
<td><p>Returns an iterator over all modules in the network, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_parameters</span></code>([prefix, recurse])</p></td>
<td><p>Returns an iterator over module parameters, yielding both the name of the parameter as well as the parameter itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">parameters</span></code>([recurse])</p></td>
<td><p>Returns an iterator over module parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_backward_hook</span></code>(hook)</p></td>
<td><p>Registers a backward hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_buffer</span></code>(name, tensor)</p></td>
<td><p>Adds a persistent buffer to the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_hook</span></code>(hook)</p></td>
<td><p>Registers a forward hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_pre_hook</span></code>(hook)</p></td>
<td><p>Registers a forward pre-hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_parameter</span></code>(name, param)</p></td>
<td><p>Adds a parameter to the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">state_dict</span></code>([destination, prefix, keep_vars])</p></td>
<td><p>Returns a dictionary containing a whole state of the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to</span></code>(*args, **kwargs)</p></td>
<td><p>Moves and/or casts the parameters and buffers.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code>([mode])</p></td>
<td><p>Sets the module in training mode.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">type</span></code>(dst_type)</p></td>
<td><p>Casts all parameters and buffers to <code class="xref py py-attr docutils literal notranslate"><span class="pre">dst_type</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">zero_grad</span></code>()</p></td>
<td><p>Sets gradients of all model parameters to zero.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>reset</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>share_memory</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="desmiles.models.Desmiles.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_seq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lengths</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/models.html#Desmiles.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.models.Desmiles.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.models.Desmiles.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/models.html#Desmiles.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.models.Desmiles.reset" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="desmiles.models.DesmilesCore">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">desmiles.models.</span></span><span class="sig-name descname"><span class="pre">DesmilesCore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vocab_sz</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp_emb_sz</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">emb_sz</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hid</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layers</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_token</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bidir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_p</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_p</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embed_p</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_p</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qrnn</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_bits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4096</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/models.html#DesmilesCore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.models.DesmilesCore" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Core Piece of DESMILES
Does everything except final softmax layer (LinearDecoder)</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(*input, **kwargs)</p></td>
<td><p>Call self as a function.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_module</span></code>(name, module)</p></td>
<td><p>Adds a child module to the current module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply</span></code>(fn)</p></td>
<td><p>Applies <code class="docutils literal notranslate"><span class="pre">fn</span></code> recursively to every submodule (as returned by <code class="docutils literal notranslate"><span class="pre">.children()</span></code>) as well as self.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">buffers</span></code>([recurse])</p></td>
<td><p>Returns an iterator over module buffers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">children</span></code>()</p></td>
<td><p>Returns an iterator over immediate children modules.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cpu</span></code>()</p></td>
<td><p>Moves all model parameters and buffers to the CPU.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cuda</span></code>([device])</p></td>
<td><p>Moves all model parameters and buffers to the GPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">double</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">double</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval</span></code>()</p></td>
<td><p>Sets the module in evaluation mode.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">extra_repr</span></code>()</p></td>
<td><p>Set the extra representation of the module</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to float datatype.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#desmiles.models.DesmilesCore.forward" title="desmiles.models.DesmilesCore.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(input_seq, input_fp, lengths)</p></td>
<td><p>Defines the computation performed at every call.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">half</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">half</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_state_dict</span></code>(state_dict[, strict])</p></td>
<td><p>Copies parameters and buffers from <code class="xref py py-attr docutils literal notranslate"><span class="pre">state_dict</span></code> into this module and its descendants.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">modules</span></code>()</p></td>
<td><p>Returns an iterator over all modules in the network.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_buffers</span></code>([prefix, recurse])</p></td>
<td><p>Returns an iterator over module buffers, yielding both the name of the buffer as well as the buffer itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_children</span></code>()</p></td>
<td><p>Returns an iterator over immediate children modules, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_modules</span></code>([memo, prefix])</p></td>
<td><p>Returns an iterator over all modules in the network, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_parameters</span></code>([prefix, recurse])</p></td>
<td><p>Returns an iterator over module parameters, yielding both the name of the parameter as well as the parameter itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">parameters</span></code>([recurse])</p></td>
<td><p>Returns an iterator over module parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_backward_hook</span></code>(hook)</p></td>
<td><p>Registers a backward hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_buffer</span></code>(name, tensor)</p></td>
<td><p>Adds a persistent buffer to the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_hook</span></code>(hook)</p></td>
<td><p>Registers a forward hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_pre_hook</span></code>(hook)</p></td>
<td><p>Registers a forward pre-hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_parameter</span></code>(name, param)</p></td>
<td><p>Adds a parameter to the module.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#desmiles.models.DesmilesCore.reset" title="desmiles.models.DesmilesCore.reset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reset</span></code></a>()</p></td>
<td><p>Reset the hidden states.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">state_dict</span></code>([destination, prefix, keep_vars])</p></td>
<td><p>Returns a dictionary containing a whole state of the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to</span></code>(*args, **kwargs)</p></td>
<td><p>Moves and/or casts the parameters and buffers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code>([mode])</p></td>
<td><p>Sets the module in training mode.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">type</span></code>(dst_type)</p></td>
<td><p>Casts all parameters and buffers to <code class="xref py py-attr docutils literal notranslate"><span class="pre">dst_type</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">zero_grad</span></code>()</p></td>
<td><p>Sets gradients of all model parameters to zero.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>share_memory</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="desmiles.models.DesmilesCore.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_seq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lengths</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/models.html#DesmilesCore.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.models.DesmilesCore.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="desmiles.models.DesmilesCore.initrange">
<span class="sig-name descname"><span class="pre">initrange</span></span><em class="property"> <span class="pre">=</span> <span class="pre">0.1</span></em><a class="headerlink" href="#desmiles.models.DesmilesCore.initrange" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.models.DesmilesCore.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/models.html#DesmilesCore.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.models.DesmilesCore.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the hidden states.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="desmiles.models.EmbeddingToSMILES">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">desmiles.models.</span></span><span class="sig-name descname"><span class="pre">EmbeddingToSMILES</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">desmiles_rnn_core</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linear_decoder</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/models.html#EmbeddingToSMILES"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.models.EmbeddingToSMILES" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Maps embedding space of fingerprints to SMILES
For simplicity of loading weights from DESMILES, I create a copy of DESMILSE and just replace
the forward() method</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(*input, **kwargs)</p></td>
<td><p>Call self as a function.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_module</span></code>(name, module)</p></td>
<td><p>Adds a child module to the current module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply</span></code>(fn)</p></td>
<td><p>Applies <code class="docutils literal notranslate"><span class="pre">fn</span></code> recursively to every submodule (as returned by <code class="docutils literal notranslate"><span class="pre">.children()</span></code>) as well as self.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">buffers</span></code>([recurse])</p></td>
<td><p>Returns an iterator over module buffers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">children</span></code>()</p></td>
<td><p>Returns an iterator over immediate children modules.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cpu</span></code>()</p></td>
<td><p>Moves all model parameters and buffers to the CPU.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cuda</span></code>([device])</p></td>
<td><p>Moves all model parameters and buffers to the GPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">double</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">double</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval</span></code>()</p></td>
<td><p>Sets the module in evaluation mode.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">extra_repr</span></code>()</p></td>
<td><p>Set the extra representation of the module</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to float datatype.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#desmiles.models.EmbeddingToSMILES.forward" title="desmiles.models.EmbeddingToSMILES.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(input_seq, input_fp, lengths)</p></td>
<td><p>Defines the computation performed at every call.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">half</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">half</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_state_dict</span></code>(state_dict[, strict])</p></td>
<td><p>Copies parameters and buffers from <code class="xref py py-attr docutils literal notranslate"><span class="pre">state_dict</span></code> into this module and its descendants.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">modules</span></code>()</p></td>
<td><p>Returns an iterator over all modules in the network.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_buffers</span></code>([prefix, recurse])</p></td>
<td><p>Returns an iterator over module buffers, yielding both the name of the buffer as well as the buffer itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_children</span></code>()</p></td>
<td><p>Returns an iterator over immediate children modules, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_modules</span></code>([memo, prefix])</p></td>
<td><p>Returns an iterator over all modules in the network, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_parameters</span></code>([prefix, recurse])</p></td>
<td><p>Returns an iterator over module parameters, yielding both the name of the parameter as well as the parameter itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">parameters</span></code>([recurse])</p></td>
<td><p>Returns an iterator over module parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_backward_hook</span></code>(hook)</p></td>
<td><p>Registers a backward hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_buffer</span></code>(name, tensor)</p></td>
<td><p>Adds a persistent buffer to the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_hook</span></code>(hook)</p></td>
<td><p>Registers a forward hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_pre_hook</span></code>(hook)</p></td>
<td><p>Registers a forward pre-hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_parameter</span></code>(name, param)</p></td>
<td><p>Adds a parameter to the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">state_dict</span></code>([destination, prefix, keep_vars])</p></td>
<td><p>Returns a dictionary containing a whole state of the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to</span></code>(*args, **kwargs)</p></td>
<td><p>Moves and/or casts the parameters and buffers.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code>([mode])</p></td>
<td><p>Sets the module in training mode.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">type</span></code>(dst_type)</p></td>
<td><p>Casts all parameters and buffers to <code class="xref py py-attr docutils literal notranslate"><span class="pre">dst_type</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">zero_grad</span></code>()</p></td>
<td><p>Sets gradients of all model parameters to zero.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>reset</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>share_memory</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="desmiles.models.EmbeddingToSMILES.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_seq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lengths</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/models.html#EmbeddingToSMILES.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.models.EmbeddingToSMILES.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.models.EmbeddingToSMILES.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/models.html#EmbeddingToSMILES.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.models.EmbeddingToSMILES.reset" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="desmiles.models.FPEmbedder">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">desmiles.models.</span></span><span class="sig-name descname"><span class="pre">FPEmbedder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vocab_sz</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp_emb_sz</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">emb_sz</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hid</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layers</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_token</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bidir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_p</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_p</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embed_p</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_p</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qrnn</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_bits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4096</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_layer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/models.html#FPEmbedder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.models.FPEmbedder" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Maps fingerprints to their pretrained embedding space
For simplicity of loading weights from DESMILES, I create a copy of DESMILESRNNCore
and just replace the forward() method</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(*input, **kwargs)</p></td>
<td><p>Call self as a function.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_module</span></code>(name, module)</p></td>
<td><p>Adds a child module to the current module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply</span></code>(fn)</p></td>
<td><p>Applies <code class="docutils literal notranslate"><span class="pre">fn</span></code> recursively to every submodule (as returned by <code class="docutils literal notranslate"><span class="pre">.children()</span></code>) as well as self.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">buffers</span></code>([recurse])</p></td>
<td><p>Returns an iterator over module buffers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">children</span></code>()</p></td>
<td><p>Returns an iterator over immediate children modules.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cpu</span></code>()</p></td>
<td><p>Moves all model parameters and buffers to the CPU.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cuda</span></code>([device])</p></td>
<td><p>Moves all model parameters and buffers to the GPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">double</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">double</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval</span></code>()</p></td>
<td><p>Sets the module in evaluation mode.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">extra_repr</span></code>()</p></td>
<td><p>Set the extra representation of the module</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to float datatype.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#desmiles.models.FPEmbedder.forward" title="desmiles.models.FPEmbedder.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(input_fp)</p></td>
<td><p>Defines the computation performed at every call.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">half</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">half</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_state_dict</span></code>(state_dict[, strict])</p></td>
<td><p>Copies parameters and buffers from <code class="xref py py-attr docutils literal notranslate"><span class="pre">state_dict</span></code> into this module and its descendants.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">modules</span></code>()</p></td>
<td><p>Returns an iterator over all modules in the network.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_buffers</span></code>([prefix, recurse])</p></td>
<td><p>Returns an iterator over module buffers, yielding both the name of the buffer as well as the buffer itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_children</span></code>()</p></td>
<td><p>Returns an iterator over immediate children modules, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_modules</span></code>([memo, prefix])</p></td>
<td><p>Returns an iterator over all modules in the network, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_parameters</span></code>([prefix, recurse])</p></td>
<td><p>Returns an iterator over module parameters, yielding both the name of the parameter as well as the parameter itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">parameters</span></code>([recurse])</p></td>
<td><p>Returns an iterator over module parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_backward_hook</span></code>(hook)</p></td>
<td><p>Registers a backward hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_buffer</span></code>(name, tensor)</p></td>
<td><p>Adds a persistent buffer to the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_hook</span></code>(hook)</p></td>
<td><p>Registers a forward hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_pre_hook</span></code>(hook)</p></td>
<td><p>Registers a forward pre-hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_parameter</span></code>(name, param)</p></td>
<td><p>Adds a parameter to the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">state_dict</span></code>([destination, prefix, keep_vars])</p></td>
<td><p>Returns a dictionary containing a whole state of the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to</span></code>(*args, **kwargs)</p></td>
<td><p>Moves and/or casts the parameters and buffers.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code>([mode])</p></td>
<td><p>Sets the module in training mode.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">type</span></code>(dst_type)</p></td>
<td><p>Casts all parameters and buffers to <code class="xref py py-attr docutils literal notranslate"><span class="pre">dst_type</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">zero_grad</span></code>()</p></td>
<td><p>Sets gradients of all model parameters to zero.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>share_memory</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="desmiles.models.FPEmbedder.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_fp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/models.html#FPEmbedder.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.models.FPEmbedder.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="desmiles.models.FPEmbedder.initrange">
<span class="sig-name descname"><span class="pre">initrange</span></span><em class="property"> <span class="pre">=</span> <span class="pre">0.1</span></em><a class="headerlink" href="#desmiles.models.FPEmbedder.initrange" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="desmiles.models.FingerprintEmbedderCore">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">desmiles.models.</span></span><span class="sig-name descname"><span class="pre">FingerprintEmbedderCore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vocab_sz</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp_emb_sz</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">emb_sz</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hid</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layers</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_token</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bidir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_p</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_p</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embed_p</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_p</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qrnn</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_bits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4096</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_layer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/models.html#FingerprintEmbedderCore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.models.FingerprintEmbedderCore" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Maps embedding space of fingerprints to SMILES
For simplicity of loading weights from DESMILES, I create a copy of DESMILSE and just replace
the forward() method</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(*input, **kwargs)</p></td>
<td><p>Call self as a function.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_module</span></code>(name, module)</p></td>
<td><p>Adds a child module to the current module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply</span></code>(fn)</p></td>
<td><p>Applies <code class="docutils literal notranslate"><span class="pre">fn</span></code> recursively to every submodule (as returned by <code class="docutils literal notranslate"><span class="pre">.children()</span></code>) as well as self.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">buffers</span></code>([recurse])</p></td>
<td><p>Returns an iterator over module buffers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">children</span></code>()</p></td>
<td><p>Returns an iterator over immediate children modules.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cpu</span></code>()</p></td>
<td><p>Moves all model parameters and buffers to the CPU.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cuda</span></code>([device])</p></td>
<td><p>Moves all model parameters and buffers to the GPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">double</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">double</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval</span></code>()</p></td>
<td><p>Sets the module in evaluation mode.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">extra_repr</span></code>()</p></td>
<td><p>Set the extra representation of the module</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to float datatype.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#desmiles.models.FingerprintEmbedderCore.forward" title="desmiles.models.FingerprintEmbedderCore.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(input_seq, input_fp, lengths)</p></td>
<td><p>Defines the computation performed at every call.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">half</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">half</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_state_dict</span></code>(state_dict[, strict])</p></td>
<td><p>Copies parameters and buffers from <code class="xref py py-attr docutils literal notranslate"><span class="pre">state_dict</span></code> into this module and its descendants.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">modules</span></code>()</p></td>
<td><p>Returns an iterator over all modules in the network.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_buffers</span></code>([prefix, recurse])</p></td>
<td><p>Returns an iterator over module buffers, yielding both the name of the buffer as well as the buffer itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_children</span></code>()</p></td>
<td><p>Returns an iterator over immediate children modules, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_modules</span></code>([memo, prefix])</p></td>
<td><p>Returns an iterator over all modules in the network, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_parameters</span></code>([prefix, recurse])</p></td>
<td><p>Returns an iterator over module parameters, yielding both the name of the parameter as well as the parameter itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">parameters</span></code>([recurse])</p></td>
<td><p>Returns an iterator over module parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_backward_hook</span></code>(hook)</p></td>
<td><p>Registers a backward hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_buffer</span></code>(name, tensor)</p></td>
<td><p>Adds a persistent buffer to the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_hook</span></code>(hook)</p></td>
<td><p>Registers a forward hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_pre_hook</span></code>(hook)</p></td>
<td><p>Registers a forward pre-hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_parameter</span></code>(name, param)</p></td>
<td><p>Adds a parameter to the module.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#desmiles.models.FingerprintEmbedderCore.reset" title="desmiles.models.FingerprintEmbedderCore.reset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reset</span></code></a>()</p></td>
<td><p>Reset the hidden states.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">state_dict</span></code>([destination, prefix, keep_vars])</p></td>
<td><p>Returns a dictionary containing a whole state of the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to</span></code>(*args, **kwargs)</p></td>
<td><p>Moves and/or casts the parameters and buffers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code>([mode])</p></td>
<td><p>Sets the module in training mode.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">type</span></code>(dst_type)</p></td>
<td><p>Casts all parameters and buffers to <code class="xref py py-attr docutils literal notranslate"><span class="pre">dst_type</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">zero_grad</span></code>()</p></td>
<td><p>Sets gradients of all model parameters to zero.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>share_memory</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="desmiles.models.FingerprintEmbedderCore.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_seq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lengths</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/models.html#FingerprintEmbedderCore.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.models.FingerprintEmbedderCore.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="desmiles.models.FingerprintEmbedderCore.initrange">
<span class="sig-name descname"><span class="pre">initrange</span></span><em class="property"> <span class="pre">=</span> <span class="pre">0.1</span></em><a class="headerlink" href="#desmiles.models.FingerprintEmbedderCore.initrange" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.models.FingerprintEmbedderCore.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/models.html#FingerprintEmbedderCore.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.models.FingerprintEmbedderCore.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the hidden states.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="desmiles.models.LinearDecoder">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">desmiles.models.</span></span><span class="sig-name descname"><span class="pre">LinearDecoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_out</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hid</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_p</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">tie_encoder</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.nn.modules.module.Module</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/models.html#LinearDecoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.models.LinearDecoder" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>To go on top of a DesmilesCore module and create a DESMILES Model.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(*input, **kwargs)</p></td>
<td><p>Call self as a function.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_module</span></code>(name, module)</p></td>
<td><p>Adds a child module to the current module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply</span></code>(fn)</p></td>
<td><p>Applies <code class="docutils literal notranslate"><span class="pre">fn</span></code> recursively to every submodule (as returned by <code class="docutils literal notranslate"><span class="pre">.children()</span></code>) as well as self.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">buffers</span></code>([recurse])</p></td>
<td><p>Returns an iterator over module buffers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">children</span></code>()</p></td>
<td><p>Returns an iterator over immediate children modules.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cpu</span></code>()</p></td>
<td><p>Moves all model parameters and buffers to the CPU.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cuda</span></code>([device])</p></td>
<td><p>Moves all model parameters and buffers to the GPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">double</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">double</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval</span></code>()</p></td>
<td><p>Sets the module in evaluation mode.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">extra_repr</span></code>()</p></td>
<td><p>Set the extra representation of the module</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to float datatype.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#desmiles.models.LinearDecoder.forward" title="desmiles.models.LinearDecoder.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(input)</p></td>
<td><p>Defines the computation performed at every call.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">half</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">half</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_state_dict</span></code>(state_dict[, strict])</p></td>
<td><p>Copies parameters and buffers from <code class="xref py py-attr docutils literal notranslate"><span class="pre">state_dict</span></code> into this module and its descendants.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">modules</span></code>()</p></td>
<td><p>Returns an iterator over all modules in the network.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_buffers</span></code>([prefix, recurse])</p></td>
<td><p>Returns an iterator over module buffers, yielding both the name of the buffer as well as the buffer itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_children</span></code>()</p></td>
<td><p>Returns an iterator over immediate children modules, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_modules</span></code>([memo, prefix])</p></td>
<td><p>Returns an iterator over all modules in the network, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_parameters</span></code>([prefix, recurse])</p></td>
<td><p>Returns an iterator over module parameters, yielding both the name of the parameter as well as the parameter itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">parameters</span></code>([recurse])</p></td>
<td><p>Returns an iterator over module parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_backward_hook</span></code>(hook)</p></td>
<td><p>Registers a backward hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_buffer</span></code>(name, tensor)</p></td>
<td><p>Adds a persistent buffer to the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_hook</span></code>(hook)</p></td>
<td><p>Registers a forward hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_pre_hook</span></code>(hook)</p></td>
<td><p>Registers a forward pre-hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_parameter</span></code>(name, param)</p></td>
<td><p>Adds a parameter to the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">state_dict</span></code>([destination, prefix, keep_vars])</p></td>
<td><p>Returns a dictionary containing a whole state of the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to</span></code>(*args, **kwargs)</p></td>
<td><p>Moves and/or casts the parameters and buffers.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code>([mode])</p></td>
<td><p>Sets the module in training mode.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">type</span></code>(dst_type)</p></td>
<td><p>Casts all parameters and buffers to <code class="xref py py-attr docutils literal notranslate"><span class="pre">dst_type</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">zero_grad</span></code>()</p></td>
<td><p>Sets gradients of all model parameters to zero.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>share_memory</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="desmiles.models.LinearDecoder.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/desmiles/models.html#LinearDecoder.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.models.LinearDecoder.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="desmiles.models.LinearDecoder.initrange">
<span class="sig-name descname"><span class="pre">initrange</span></span><em class="property"> <span class="pre">=</span> <span class="pre">0.1</span></em><a class="headerlink" href="#desmiles.models.LinearDecoder.initrange" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="desmiles.models.RecurrentDESMILES">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">desmiles.models.</span></span><span class="sig-name descname"><span class="pre">RecurrentDESMILES</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">desmiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp_embedding_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">1)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/models.html#RecurrentDESMILES"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.models.RecurrentDESMILES" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>RecurrentDESMILES is a reimplimentation of DESMILES model which provides separate functions
for the fingerprint embedding and the decoding. This is used heavily in decoding methods 
such as beam search and A*</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(*input, **kwargs)</p></td>
<td><p>Call self as a function.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_module</span></code>(name, module)</p></td>
<td><p>Adds a child module to the current module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply</span></code>(fn)</p></td>
<td><p>Applies <code class="docutils literal notranslate"><span class="pre">fn</span></code> recursively to every submodule (as returned by <code class="docutils literal notranslate"><span class="pre">.children()</span></code>) as well as self.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">buffers</span></code>([recurse])</p></td>
<td><p>Returns an iterator over module buffers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">children</span></code>()</p></td>
<td><p>Returns an iterator over immediate children modules.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cpu</span></code>()</p></td>
<td><p>Moves all model parameters and buffers to the CPU.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cuda</span></code>([device])</p></td>
<td><p>Moves all model parameters and buffers to the GPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">double</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">double</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval</span></code>()</p></td>
<td><p>Sets the module in evaluation mode.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">extra_repr</span></code>()</p></td>
<td><p>Set the extra representation of the module</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to float datatype.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#desmiles.models.RecurrentDESMILES.forward" title="desmiles.models.RecurrentDESMILES.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(seq)</p></td>
<td><p>Defines the computation performed at every call.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">half</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">half</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_state_dict</span></code>(state_dict[, strict])</p></td>
<td><p>Copies parameters and buffers from <code class="xref py py-attr docutils literal notranslate"><span class="pre">state_dict</span></code> into this module and its descendants.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">modules</span></code>()</p></td>
<td><p>Returns an iterator over all modules in the network.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_buffers</span></code>([prefix, recurse])</p></td>
<td><p>Returns an iterator over module buffers, yielding both the name of the buffer as well as the buffer itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_children</span></code>()</p></td>
<td><p>Returns an iterator over immediate children modules, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_modules</span></code>([memo, prefix])</p></td>
<td><p>Returns an iterator over all modules in the network, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_parameters</span></code>([prefix, recurse])</p></td>
<td><p>Returns an iterator over module parameters, yielding both the name of the parameter as well as the parameter itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">parameters</span></code>([recurse])</p></td>
<td><p>Returns an iterator over module parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_backward_hook</span></code>(hook)</p></td>
<td><p>Registers a backward hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_buffer</span></code>(name, tensor)</p></td>
<td><p>Adds a persistent buffer to the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_hook</span></code>(hook)</p></td>
<td><p>Registers a forward hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_pre_hook</span></code>(hook)</p></td>
<td><p>Registers a forward pre-hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_parameter</span></code>(name, param)</p></td>
<td><p>Adds a parameter to the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">state_dict</span></code>([destination, prefix, keep_vars])</p></td>
<td><p>Returns a dictionary containing a whole state of the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to</span></code>(*args, **kwargs)</p></td>
<td><p>Moves and/or casts the parameters and buffers.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code>([mode])</p></td>
<td><p>Sets the module in training mode.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">type</span></code>(dst_type)</p></td>
<td><p>Casts all parameters and buffers to <code class="xref py py-attr docutils literal notranslate"><span class="pre">dst_type</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">zero_grad</span></code>()</p></td>
<td><p>Sets gradients of all model parameters to zero.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 69%" />
<col style="width: 31%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>embed_fingerprints</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>one_hidden</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>reset</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>select_hidden</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>set_hiddens</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>share_memory</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="desmiles.models.RecurrentDESMILES.embed_fingerprints">
<span class="sig-name descname"><span class="pre">embed_fingerprints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/models.html#RecurrentDESMILES.embed_fingerprints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.models.RecurrentDESMILES.embed_fingerprints" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.models.RecurrentDESMILES.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/models.html#RecurrentDESMILES.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.models.RecurrentDESMILES.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="desmiles.models.RecurrentDESMILES.initrange">
<span class="sig-name descname"><span class="pre">initrange</span></span><em class="property"> <span class="pre">=</span> <span class="pre">0.1</span></em><a class="headerlink" href="#desmiles.models.RecurrentDESMILES.initrange" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.models.RecurrentDESMILES.one_hidden">
<span class="sig-name descname"><span class="pre">one_hidden</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/models.html#RecurrentDESMILES.one_hidden"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.models.RecurrentDESMILES.one_hidden" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.models.RecurrentDESMILES.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/models.html#RecurrentDESMILES.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.models.RecurrentDESMILES.reset" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.models.RecurrentDESMILES.select_hidden">
<span class="sig-name descname"><span class="pre">select_hidden</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idxs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/models.html#RecurrentDESMILES.select_hidden"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.models.RecurrentDESMILES.select_hidden" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.models.RecurrentDESMILES.set_hiddens">
<span class="sig-name descname"><span class="pre">set_hiddens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hiddens</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/models.html#RecurrentDESMILES.set_hiddens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.models.RecurrentDESMILES.set_hiddens" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="desmiles.models.get_desmiles_model">
<span class="sig-prename descclassname"><span class="pre">desmiles.models.</span></span><span class="sig-name descname"><span class="pre">get_desmiles_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vocab_sz</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp_emb_sz</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">emb_sz</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hid</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layers</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_token</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tie_weights</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qrnn</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bidir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_p</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_p</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_p</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embed_p</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_p</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_bits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4096</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.nn.modules.module.Module</span></span></span><a class="reference internal" href="_modules/desmiles/models.html#get_desmiles_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.models.get_desmiles_model" title="Permalink to this definition"></a></dt>
<dd><p>Create a full DESMILES model.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="desmiles.models.get_embedded_fp_to_smiles_model">
<span class="sig-prename descclassname"><span class="pre">desmiles.models.</span></span><span class="sig-name descname"><span class="pre">get_embedded_fp_to_smiles_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">desmiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_layer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/models.html#get_embedded_fp_to_smiles_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.models.get_embedded_fp_to_smiles_model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="desmiles.models.get_fp_to_embedding_model">
<span class="sig-prename descclassname"><span class="pre">desmiles.models.</span></span><span class="sig-name descname"><span class="pre">get_fp_to_embedding_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">desmiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_layer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/models.html#get_fp_to_embedding_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.models.get_fp_to_embedding_model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-desmiles.learner">
<span id="desmiles-learner"></span><h3>desmiles.learner<a class="headerlink" href="#module-desmiles.learner" title="Permalink to this headline"></a></h3>
<p>Model training for NLP</p>
<dl class="py class">
<dt class="sig sig-object py" id="desmiles.learner.DesmilesLearner">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">desmiles.learner.</span></span><span class="sig-name descname"><span class="pre">DesmilesLearner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">fastai.basic_data.DataBunch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.nn.modules.module.Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_func</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">torch.nn.modules.module.Module</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.nn.modules.module.Module</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">learn_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/learner.html#DesmilesLearner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.learner.DesmilesLearner" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">fastai.text.learner.RNNLearner</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>callback_fns</strong></dt><dd></dd>
<dt><strong>layer_groups</strong></dt><dd></dd>
<dt><strong>loss_func</strong></dt><dd></dd>
<dt><strong>metrics</strong></dt><dd></dd>
<dt><strong>path</strong></dt><dd></dd>
<dt><strong>silent</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_dropout</span></code>(m)</p></td>
<td><p>If a module contains 'dropout' in it's name, it will be switched to .train() mode.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">backward</span></code>(item)</p></td>
<td><p>Pass <cite>item</cite> through the model and computes the gradient.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">clip_grad</span></code>([clip])</p></td>
<td><p>Add gradient clipping of <cite>clip</cite> during training.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_opt</span></code>(lr[, wd])</p></td>
<td><p>Create optimizer with <cite>lr</cite> learning rate and <cite>wd</cite> weight decay.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">destroy</span></code>()</p></td>
<td><p>Free the Learner internals, leaving just an empty shell that consumes no memory</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">dl</span></code>([ds_type])</p></td>
<td><p>Return DataLoader for DatasetType <cite>ds_type</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">export</span></code>([file, destroy])</p></td>
<td><p>Export the state of the <cite>Learner</cite> in <cite>self.path/file</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit</span></code>(epochs[, lr, wd, callbacks])</p></td>
<td><p>Fit the model on this learner with <cite>lr</cite> learning rate, <cite>wd</cite> weight decay for <cite>epochs</cite> with <cite>callbacks</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_one_cycle</span></code>(cyc_len[, max_lr, moms, ...])</p></td>
<td><p>Fit a model following the 1cycle policy.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">freeze</span></code>()</p></td>
<td><p>Freeze up to last layer group.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">freeze_to</span></code>(n)</p></td>
<td><p>Freeze layers up to layer group <cite>n</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_preds</span></code>([ds_type, with_loss, n_batch, ...])</p></td>
<td><p>Return predictions and targets on the valid, train, or test set, depending on <cite>ds_type</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">interpret</span></code>([ds_type])</p></td>
<td><p>Create a <cite>ClassificationInterpretation</cite> object from <cite>learner</cite> on <cite>ds_type</cite> with <cite>tta</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load</span></code>([file, device, strict, with_opt, ...])</p></td>
<td><p>Load model and optimizer state (if <cite>with_opt</cite>) <cite>file</cite> from <cite>self.model_dir</cite> using <cite>device</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_encoder</span></code>(name[, device])</p></td>
<td><p>Load the encoder <cite>name</cite> from the model directory.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#desmiles.learner.DesmilesLearner.load_old" title="desmiles.learner.DesmilesLearner.load_old"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_old</span></code></a>(name[, device, strict, with_opt, ...])</p></td>
<td><p>Load the weights from an old (i.e.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_pretrained</span></code>(wgts_fname, itos_fname[, strict])</p></td>
<td><p>Load a pretrained model and adapts it to the data vocabulary.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">lr_find</span></code>([start_lr, end_lr, num_it, stop_div, wd])</p></td>
<td><p>Explore lr from <cite>start_lr</cite> to <cite>end_lr</cite> over <cite>num_it</cite> iterations in <cite>learn</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">lr_range</span></code>(lr)</p></td>
<td><p>Build differential learning rates from <cite>lr</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">mixup</span></code>([alpha, stack_x, stack_y])</p></td>
<td><p>Add mixup <a class="reference external" href="https://arxiv.org/abs/1710.09412">https://arxiv.org/abs/1710.09412</a> to <cite>learn</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">opt_func</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">pred_batch</span></code>([ds_type, batch, reconstruct, ...])</p></td>
<td><p>Return output of the model on one batch from <cite>ds_type</cite> dataset.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code>(item[, return_x, batch_first, ...])</p></td>
<td><p>Return predicted class, label and probabilities for <cite>item</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict_with_mc_dropout</span></code>(item[, ...])</p></td>
<td><p>Make predictions with dropout turned on for n_times (default 10).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">purge</span></code>([clear_opt])</p></td>
<td><p>Purge the <cite>Learner</cite> of all cached attributes to release some GPU memory.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>([file, return_path, with_opt])</p></td>
<td><p>Save model and optimizer state (if <cite>with_opt</cite>) with <cite>file</cite> to <cite>self.model_dir</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_encoder</span></code>(name)</p></td>
<td><p>Save the encoder to <cite>name</cite> inside the model directory.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">show_results</span></code>([ds_type, rows])</p></td>
<td><p>Show <cite>rows</cite> result of predictions on <cite>ds_type</cite> dataset.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">split</span></code>(split_on)</p></td>
<td><p>Split the model at <cite>split_on</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code>([n])</p></td>
<td><p>Print a summary of <cite>m</cite> using a output text width of <cite>n</cite> chars</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_fp16</span></code>([loss_scale, max_noskip, dynamic, ...])</p></td>
<td><p>Put <cite>learn</cite> in FP16 precision mode.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_fp32</span></code>()</p></td>
<td><p>Put <cite>learn</cite> back to FP32 precision mode.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">unfreeze</span></code>()</p></td>
<td><p>Unfreeze entire model.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">validate</span></code>([dl, callbacks, metrics])</p></td>
<td><p>Validate on <cite>dl</cite> with potential <cite>callbacks</cite> and <cite>metrics</cite>.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 73%" />
<col style="width: 27%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>init</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>replace_name</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>replace_sequential_name</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="desmiles.learner.DesmilesLearner.callbacks">
<span class="sig-name descname"><span class="pre">callbacks</span></span><em class="property"><span class="pre">:</span> <span class="pre">Collection</span><span class="p"><span class="pre">[</span></span><span class="pre">fastai.callback.Callback</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#desmiles.learner.DesmilesLearner.callbacks" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="desmiles.learner.DesmilesLearner.data">
<span class="sig-name descname"><span class="pre">data</span></span><em class="property"><span class="pre">:</span> <span class="pre">fastai.basic_data.DataBunch</span></em><a class="headerlink" href="#desmiles.learner.DesmilesLearner.data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.learner.DesmilesLearner.load_old">
<span class="sig-name descname"><span class="pre">load_old</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.10)"><span class="pre">pathlib.Path</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.device</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_opt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/learner.html#DesmilesLearner.load_old"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.learner.DesmilesLearner.load_old" title="Permalink to this definition"></a></dt>
<dd><p>Load the weights from an old (i.e. python3.6 and pytorch 0.4 DESMILES model)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="desmiles.learner.DesmilesLearner.model">
<span class="sig-name descname"><span class="pre">model</span></span><em class="property"><span class="pre">:</span> <span class="pre">torch.nn.modules.module.Module</span></em><a class="headerlink" href="#desmiles.learner.DesmilesLearner.model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.learner.DesmilesLearner.replace_name">
<span class="sig-name descname"><span class="pre">replace_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/learner.html#DesmilesLearner.replace_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.learner.DesmilesLearner.replace_name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.learner.DesmilesLearner.replace_sequential_name">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">replace_sequential_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/learner.html#DesmilesLearner.replace_sequential_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.learner.DesmilesLearner.replace_sequential_name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="desmiles.learner.OriginalFastaiOneCycleScheduler">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">desmiles.learner.</span></span><span class="sig-name descname"><span class="pre">OriginalFastaiOneCycleScheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">learn</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">fastai.basic_train.Learner</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_max</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">moms</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">Collection</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">(0.8,</span> <span class="pre">0.6)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">div_factor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_inc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_dec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.49</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tot_epochs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_epoch</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/learner.html#OriginalFastaiOneCycleScheduler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.learner.OriginalFastaiOneCycleScheduler" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">fastai.basic_train.LearnerCallback</span></code></p>
<p>Scheduler that mimics the original Fastai one-cycle learner</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>cb_name</strong></dt><dd></dd>
<dt><strong>learn</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_state</span></code>([minimal])</p></td>
<td><p>Return the inner state of the <cite>Callback</cite>, <cite>minimal</cite> or not.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#desmiles.learner.OriginalFastaiOneCycleScheduler.jump_to_epoch" title="desmiles.learner.OriginalFastaiOneCycleScheduler.jump_to_epoch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">jump_to_epoch</span></code></a>(epoch)</p></td>
<td><p>To resume training at <cite>epoch</cite> directly.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">on_backward_begin</span></code>(**kwargs)</p></td>
<td><p>Called after the forward pass and the loss has been computed, but before backprop.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">on_backward_end</span></code>(**kwargs)</p></td>
<td><p>Called after backprop but before optimizer step.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">on_batch_begin</span></code>(**kwargs)</p></td>
<td><p>Set HP before the output and loss are computed.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#desmiles.learner.OriginalFastaiOneCycleScheduler.on_batch_end" title="desmiles.learner.OriginalFastaiOneCycleScheduler.on_batch_end"><code class="xref py py-obj docutils literal notranslate"><span class="pre">on_batch_end</span></code></a>(train, **kwargs)</p></td>
<td><p>Take one step forward on the annealing schedule for the optim params.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">on_epoch_begin</span></code>(**kwargs)</p></td>
<td><p>At the beginning of each epoch.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#desmiles.learner.OriginalFastaiOneCycleScheduler.on_epoch_end" title="desmiles.learner.OriginalFastaiOneCycleScheduler.on_epoch_end"><code class="xref py py-obj docutils literal notranslate"><span class="pre">on_epoch_end</span></code></a>(epoch, **kwargs)</p></td>
<td><p>Tell Learner to stop if the cycle is finished.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">on_loss_begin</span></code>(**kwargs)</p></td>
<td><p>Called after forward pass but before loss has been computed.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">on_step_end</span></code>(**kwargs)</p></td>
<td><p>Called after the step of the optimizer but before the gradients are zeroed.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#desmiles.learner.OriginalFastaiOneCycleScheduler.on_train_begin" title="desmiles.learner.OriginalFastaiOneCycleScheduler.on_train_begin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">on_train_begin</span></code></a>(n_epochs, epoch, **kwargs)</p></td>
<td><p>Initialize our optimization params based on our annealing schedule.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">on_train_end</span></code>(**kwargs)</p></td>
<td><p>Useful for cleaning up things and saving files/models.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#desmiles.learner.OriginalFastaiOneCycleScheduler.steps" title="desmiles.learner.OriginalFastaiOneCycleScheduler.steps"><code class="xref py py-obj docutils literal notranslate"><span class="pre">steps</span></code></a>(*steps_cfg)</p></td>
<td><p>Build anneal schedule for all of the parameters.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="desmiles.learner.OriginalFastaiOneCycleScheduler.jump_to_epoch">
<span class="sig-name descname"><span class="pre">jump_to_epoch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/desmiles/learner.html#OriginalFastaiOneCycleScheduler.jump_to_epoch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.learner.OriginalFastaiOneCycleScheduler.jump_to_epoch" title="Permalink to this definition"></a></dt>
<dd><p>To resume training at <cite>epoch</cite> directly.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.learner.OriginalFastaiOneCycleScheduler.on_batch_end">
<span class="sig-name descname"><span class="pre">on_batch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/desmiles/learner.html#OriginalFastaiOneCycleScheduler.on_batch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.learner.OriginalFastaiOneCycleScheduler.on_batch_end" title="Permalink to this definition"></a></dt>
<dd><p>Take one step forward on the annealing schedule for the optim params.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.learner.OriginalFastaiOneCycleScheduler.on_epoch_end">
<span class="sig-name descname"><span class="pre">on_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/desmiles/learner.html#OriginalFastaiOneCycleScheduler.on_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.learner.OriginalFastaiOneCycleScheduler.on_epoch_end" title="Permalink to this definition"></a></dt>
<dd><p>Tell Learner to stop if the cycle is finished.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.learner.OriginalFastaiOneCycleScheduler.on_train_begin">
<span class="sig-name descname"><span class="pre">on_train_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_epochs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/desmiles/learner.html#OriginalFastaiOneCycleScheduler.on_train_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.learner.OriginalFastaiOneCycleScheduler.on_train_begin" title="Permalink to this definition"></a></dt>
<dd><p>Initialize our optimization params based on our annealing schedule.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.learner.OriginalFastaiOneCycleScheduler.steps">
<span class="sig-name descname"><span class="pre">steps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">steps_cfg</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/learner.html#OriginalFastaiOneCycleScheduler.steps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.learner.OriginalFastaiOneCycleScheduler.steps" title="Permalink to this definition"></a></dt>
<dd><p>Build anneal schedule for all of the parameters.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="desmiles.learner.desmiles_model_learner">
<span class="sig-prename descclassname"><span class="pre">desmiles.learner.</span></span><span class="sig-name descname"><span class="pre">desmiles_model_learner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">fastai.basic_data.DataBunch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp_emb_sz</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emb_sz</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nh</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nl</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_token</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_mult</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tie_weights</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qrnn</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_bits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4096</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropouts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.25,</span> <span class="pre">0.1,</span> <span class="pre">0.2,</span> <span class="pre">0.02,</span> <span class="pre">0.15)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">LanguageLearner</span></span></span><a class="reference internal" href="_modules/desmiles/learner.html#desmiles_model_learner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.learner.desmiles_model_learner" title="Permalink to this definition"></a></dt>
<dd><p>Create a <cite>DesmilesLearner</cite> with a DESMILES model from <cite>data</cite>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="desmiles.learner.desmiles_split">
<span class="sig-prename descclassname"><span class="pre">desmiles.learner.</span></span><span class="sig-name descname"><span class="pre">desmiles_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.nn.modules.module.Module</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.nn.modules.module.Module</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/desmiles/learner.html#desmiles_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.learner.desmiles_split" title="Permalink to this definition"></a></dt>
<dd><p>Split a DESMILES <cite>model</cite> in groups for differential learning rates.
This is currently never used but could be used in the future</p>
</dd></dl>

</section>
<section id="module-desmiles.data">
<span id="desmiles-data"></span><h3>desmiles.data<a class="headerlink" href="#module-desmiles.data" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="desmiles.data.DesmilesLoader">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">desmiles.data.</span></span><span class="sig-name descname"><span class="pre">DesmilesLoader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#desmiles.data.FpSmilesList" title="desmiles.data.FpSmilesList"><span class="pre">desmiles.data.FpSmilesList</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">bs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vocab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/data.html#DesmilesLoader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.data.DesmilesLoader" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Create a dataloader for desmiles.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="desmiles.data.FpSmiles">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">desmiles.data.</span></span><span class="sig-name descname"><span class="pre">FpSmiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/data.html#FpSmiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.data.FpSmiles" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">fastai.core.ItemBase</span></code></p>
<p>Base item type in the fastai library.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#desmiles.data.FpSmiles.apply_tfms" title="desmiles.data.FpSmiles.apply_tfms"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_tfms</span></code></a>(tfms, **kwargs)</p></td>
<td><p>Subclass this method if you want to apply data augmentation with <cite>tfms</cite> to this <cite>ItemBase</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#desmiles.data.FpSmiles.show" title="desmiles.data.FpSmiles.show"><code class="xref py py-obj docutils literal notranslate"><span class="pre">show</span></code></a>()</p></td>
<td><p>Subclass this method if you want to customize the way this <cite>ItemBase</cite> is shown on <cite>ax</cite>.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="desmiles.data.FpSmiles.apply_tfms">
<span class="sig-name descname"><span class="pre">apply_tfms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tfms</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Collection</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/data.html#FpSmiles.apply_tfms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.data.FpSmiles.apply_tfms" title="Permalink to this definition"></a></dt>
<dd><p>Subclass this method if you want to apply data augmentation with <cite>tfms</cite> to this <cite>ItemBase</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.data.FpSmiles.show">
<span class="sig-name descname"><span class="pre">show</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/data.html#FpSmiles.show"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.data.FpSmiles.show" title="Permalink to this definition"></a></dt>
<dd><p>Subclass this method if you want to customize the way this <cite>ItemBase</cite> is shown on <cite>ax</cite>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="desmiles.data.FpSmilesList">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">desmiles.data.</span></span><span class="sig-name descname"><span class="pre">FpSmilesList</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ids</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Collection</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Scipy.Sparse</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vocab</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">fastai.text.transform.Vocab</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_idx</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/data.html#FpSmilesList"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.data.FpSmilesList" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">fastai.data_block.ItemList</span></code></p>
<p>Basic <cite>ItemList</cite> for FpSmiles data.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">analyze_pred</span></code>(pred)</p></td>
<td><p>Called on <cite>pred</cite> before <cite>reconstruct</cite> for additional preprocessing.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">databunch</span></code>(**kwargs)</p></td>
<td><p>To throw a clear error message when the data wasn't split and labeled.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_folder</span></code>([include, exclude])</p></td>
<td><p>Only keep filenames in <cite>include</cite> folder or reject the ones in <cite>exclude</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_func</span></code>(func)</p></td>
<td><p>Only keep elements for which <cite>func</cite> returns <cite>True</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_by_rand</span></code>(p[, seed])</p></td>
<td><p>Keep random sample of <cite>items</cite> with probability <cite>p</cite> and an optional <cite>seed</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_csv</span></code>(path, csv_name[, cols, delimiter, ...])</p></td>
<td><p>Create an <cite>ItemList</cite> in <cite>path</cite> from the inputs in the <cite>cols</cite> of <cite>path/csv_name</cite></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_df</span></code>(df[, path, cols, processor])</p></td>
<td><p>Create an <cite>ItemList</cite> in <cite>path</cite> from the inputs in the <cite>cols</cite> of <cite>df</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_folder</span></code>(path[, extensions, recurse, ...])</p></td>
<td><p>Create an <cite>ItemList</cite> in <cite>path</cite> from the filenames that have a suffix in <cite>extensions</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#desmiles.data.FpSmilesList.get" title="desmiles.data.FpSmilesList.get"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get</span></code></a>(i)</p></td>
<td><p>Subclass if you want to customize how to create item <cite>i</cite> from <cite>self.items</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_label_cls</span></code>(labels[, label_cls, label_delim])</p></td>
<td><p>Return <cite>label_cls</cite> or guess one from the first element of <cite>labels</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">label_const</span></code>([const, label_cls])</p></td>
<td><p>Label every item with <cite>const</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">label_empty</span></code>(**kwargs)</p></td>
<td><p>Label every item with an <cite>EmptyLabel</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">label_from_df</span></code>([cols, label_cls])</p></td>
<td><p>Label <cite>self.items</cite> from the values in <cite>cols</cite> in <cite>self.inner_df</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">label_from_folder</span></code>([label_cls])</p></td>
<td><p>Give a label to each filename depending on its folder.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">label_from_func</span></code>(func[, label_cls])</p></td>
<td><p>Apply <cite>func</cite> to every input to get its label.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">label_from_re</span></code>(pat[, full_path, label_cls])</p></td>
<td><p>Apply the re in <cite>pat</cite> to determine the label of every filename.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">new</span></code>(items[, processor])</p></td>
<td><p>Create a new <cite>ItemList</cite> from <cite>items</cite>, keeping the same attributes.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">process</span></code>([processor])</p></td>
<td><p>Apply <cite>processor</cite> or <cite>self.processor</cite> to <cite>self</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">process_one</span></code>(item[, processor])</p></td>
<td><p>Apply <cite>processor</cite> or <cite>self.processor</cite> to <cite>item</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#desmiles.data.FpSmilesList.reconstruct" title="desmiles.data.FpSmilesList.reconstruct"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reconstruct</span></code></a>(ids, fp)</p></td>
<td><p>Reconstruct one of the underlying item for its data <cite>t</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">split_by_files</span></code>(valid_names)</p></td>
<td><p>Split the data by using the names in <cite>valid_names</cite> for validation.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">split_by_fname_file</span></code>(fname[, path])</p></td>
<td><p>Split the data by using the names in <cite>fname</cite> for the validation set.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">split_by_folder</span></code>([train, valid])</p></td>
<td><p>Split the data depending on the folder (<cite>train</cite> or <cite>valid</cite>) in which the filenames are.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">split_by_idx</span></code>(valid_idx)</p></td>
<td><p>Split the data according to the indexes in <cite>valid_idx</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">split_by_idxs</span></code>(train_idx, valid_idx)</p></td>
<td><p>Split the data between <cite>train_idx</cite> and <cite>valid_idx</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">split_by_list</span></code>(train, valid)</p></td>
<td><p>Split the data between <cite>train</cite> and <cite>valid</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">split_by_rand_pct</span></code>([valid_pct, seed])</p></td>
<td><p>Split the items randomly by putting <cite>valid_pct</cite> in the validation set, optional <cite>seed</cite> can be passed.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">split_by_valid_func</span></code>(func)</p></td>
<td><p>Split the data by result of <cite>func</cite> (which returns <cite>True</cite> for validation set).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">split_from_df</span></code>([col])</p></td>
<td><p>Split the data from the <cite>col</cite> in the dataframe in <cite>self.inner_df</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">split_none</span></code>()</p></td>
<td><p>Don't split the data and create an empty validation set.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">split_subsets</span></code>(train_size, valid_size[, seed])</p></td>
<td><p>Split the items into train set with size <cite>train_size * n</cite> and valid set with size <cite>valid_size * n</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_text</span></code>(fn)</p></td>
<td><p>Save <cite>self.items</cite> to <cite>fn</cite> in <cite>self.path</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">use_partial_data</span></code>([sample_pct, seed])</p></td>
<td><p>Use only a sample of <cite>sample_pct`of the full dataset and an optional `seed</cite>.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 70%" />
<col style="width: 30%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>add</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>no_split</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>random_split_by_pct</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="desmiles.data.FpSmilesList.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/data.html#FpSmilesList.get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.data.FpSmilesList.get" title="Permalink to this definition"></a></dt>
<dd><p>Subclass if you want to customize how to create item <cite>i</cite> from <cite>self.items</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.data.FpSmilesList.reconstruct">
<span class="sig-name descname"><span class="pre">reconstruct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ids</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/data.html#FpSmilesList.reconstruct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.data.FpSmilesList.reconstruct" title="Permalink to this definition"></a></dt>
<dd><p>Reconstruct one of the underlying item for its data <cite>t</cite>.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="desmiles.data.as_tensor">
<span class="sig-prename descclassname"><span class="pre">desmiles.data.</span></span><span class="sig-name descname"><span class="pre">as_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#desmiles.data.as_tensor" title="Permalink to this definition"></a></dt>
<dd><p>Convert the data into a <cite>torch.Tensor</cite>. If the data is already a <cite>Tensor</cite> with the same <cite>dtype</cite> and <cite>device</cite>,
no copy will be performed, otherwise a new <cite>Tensor</cite> will be returned with computational graph retained if data
<cite>Tensor</cite> has <code class="docutils literal notranslate"><span class="pre">requires_grad=True</span></code>. Similarly, if the data is an <code class="docutils literal notranslate"><span class="pre">ndarray</span></code> of the corresponding <cite>dtype</cite> and
the <cite>device</cite> is the cpu, no copy will be performed.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>data (array_like): Initial data for the tensor. Can be a list, tuple,</dt><dd><p>NumPy <code class="docutils literal notranslate"><span class="pre">ndarray</span></code>, scalar, and other types.</p>
</dd>
<dt>dtype (<code class="xref py py-class docutils literal notranslate"><span class="pre">torch.dtype</span></code>, optional): the desired data type of returned tensor.</dt><dd><p>Default: if <code class="docutils literal notranslate"><span class="pre">None</span></code>, infers data type from <code class="xref py py-attr docutils literal notranslate"><span class="pre">data</span></code>.</p>
</dd>
<dt>device (<code class="xref py py-class docutils literal notranslate"><span class="pre">torch.device</span></code>, optional): the desired device of returned tensor.</dt><dd><p>Default: if <code class="docutils literal notranslate"><span class="pre">None</span></code>, uses the current device for the default tensor type
(see <code class="xref py py-func docutils literal notranslate"><span class="pre">torch.set_default_tensor_type()</span></code>). <code class="xref py py-attr docutils literal notranslate"><span class="pre">device</span></code> will be the CPU
for CPU tensor types and the current CUDA device for CUDA tensor types.</p>
</dd>
</dl>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go">tensor([ 1,  2,  3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">array([-1,  2,  3])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cuda&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go">tensor([ 1,  2,  3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">array([1,  2,  3])</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-desmiles.decoding.astar">
<span id="desmiles-decoding"></span><h3>desmiles.decoding<a class="headerlink" href="#module-desmiles.decoding.astar" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTree">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">desmiles.decoding.astar.</span></span><span class="sig-name descname"><span class="pre">AstarTree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desmiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_branches</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTree" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p class="rubric">Methods</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 73%" />
<col style="width: 27%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>add_children_to_queue</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>are_children_leaf_nodes</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>bound</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>branch</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>branch_and_bound</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>clone_hidden_states</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>create_from_astar_tree</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_children</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_log_probabilities</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>initialize_root_node</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>purge_queue</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>return_leaf_node</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>sort_scores</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTree.add_children_to_queue">
<span class="sig-name descname"><span class="pre">add_children_to_queue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scores</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTree.add_children_to_queue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTree.add_children_to_queue" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTree.are_children_leaf_nodes">
<span class="sig-name descname"><span class="pre">are_children_leaf_nodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">children</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTree.are_children_leaf_nodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTree.are_children_leaf_nodes" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTree.bound">
<span class="sig-name descname"><span class="pre">bound</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scores</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTree.bound"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTree.bound" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTree.branch">
<span class="sig-name descname"><span class="pre">branch</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTree.branch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTree.branch" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTree.branch_and_bound">
<span class="sig-name descname"><span class="pre">branch_and_bound</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTree.branch_and_bound"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTree.branch_and_bound" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTree.clone_hidden_states">
<span class="sig-name descname"><span class="pre">clone_hidden_states</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seqs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTree.clone_hidden_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTree.clone_hidden_states" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTree.create_from_astar_tree">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">create_from_astar_tree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTree.create_from_astar_tree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTree.create_from_astar_tree" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTree.get_children">
<span class="sig-name descname"><span class="pre">get_children</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_probs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_nlps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTree.get_children"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTree.get_children" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTree.get_log_probabilities">
<span class="sig-name descname"><span class="pre">get_log_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seqs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTree.get_log_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTree.get_log_probabilities" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTree.initialize_root_node">
<span class="sig-name descname"><span class="pre">initialize_root_node</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTree.initialize_root_node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTree.initialize_root_node" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTree.purge_queue">
<span class="sig-name descname"><span class="pre">purge_queue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">downto</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTree.purge_queue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTree.purge_queue" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTree.return_leaf_node">
<span class="sig-name descname"><span class="pre">return_leaf_node</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTree.return_leaf_node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTree.return_leaf_node" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTree.sort_scores">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">sort_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_branches</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTree.sort_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTree.sort_scores" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTreeParallel">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">desmiles.decoding.astar.</span></span><span class="sig-name descname"><span class="pre">AstarTreeParallel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desmiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_branches</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_expand</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTreeParallel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTreeParallel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#desmiles.decoding.astar.AstarTree" title="desmiles.decoding.astar.AstarTree"><code class="xref py py-class docutils literal notranslate"><span class="pre">desmiles.decoding.astar.AstarTree</span></code></a></p>
<p class="rubric">Methods</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 73%" />
<col style="width: 27%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>add_children_to_queue</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>are_children_leaf_nodes</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>bound</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>branch</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>branch_and_bound</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>clone_hidden_states</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>create_from_astar_tree</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_children</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_log_probabilities</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>initialize_root_node</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>purge_queue</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>return_leaf_node</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>sort_by_length</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>sort_lengths</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>sort_scores</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTreeParallel.branch">
<span class="sig-name descname"><span class="pre">branch</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTreeParallel.branch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTreeParallel.branch" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTreeParallel.sort_by_length">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">sort_by_length</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scores</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTreeParallel.sort_by_length"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTreeParallel.sort_by_length" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTreeParallel.sort_lengths">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">sort_lengths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lengths</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTreeParallel.sort_lengths"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTreeParallel.sort_lengths" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTreeParallelHybrid">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">desmiles.decoding.astar.</span></span><span class="sig-name descname"><span class="pre">AstarTreeParallelHybrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desmiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_branches</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_expand</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTreeParallelHybrid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTreeParallelHybrid" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#desmiles.decoding.astar.AstarTreeParallelNotSafe" title="desmiles.decoding.astar.AstarTreeParallelNotSafe"><code class="xref py py-class docutils literal notranslate"><span class="pre">desmiles.decoding.astar.AstarTreeParallelNotSafe</span></code></a></p>
<p class="rubric">Methods</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 77%" />
<col style="width: 23%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>add_children_to_queue</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>are_children_leaf_nodes</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>bound</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>branch</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>branch_and_bound</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>clone_hiddens</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>concat_hiddens</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_children</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_log_probabilities</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_seq_idx</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>initialize_root_node</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>make_queue_with_right_padding</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>purge_queue</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>return_leaf_node</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>select_all_hiddens</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>select_hiddens</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>sort_scores</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTreeParallelHybrid.make_queue_with_right_padding">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">make_queue_with_right_padding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">queue</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTreeParallelHybrid.make_queue_with_right_padding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTreeParallelHybrid.make_queue_with_right_padding" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTreeParallelNotSafe">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">desmiles.decoding.astar.</span></span><span class="sig-name descname"><span class="pre">AstarTreeParallelNotSafe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desmiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_branches</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_expand</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTreeParallelNotSafe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTreeParallelNotSafe" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p class="rubric">Methods</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 73%" />
<col style="width: 27%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>add_children_to_queue</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>are_children_leaf_nodes</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>bound</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>branch</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>branch_and_bound</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>clone_hiddens</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>concat_hiddens</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_children</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_log_probabilities</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_seq_idx</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>initialize_root_node</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>purge_queue</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>return_leaf_node</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>select_all_hiddens</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>select_hiddens</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>sort_scores</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTreeParallelNotSafe.add_children_to_queue">
<span class="sig-name descname"><span class="pre">add_children_to_queue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq_idxs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTreeParallelNotSafe.add_children_to_queue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTreeParallelNotSafe.add_children_to_queue" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTreeParallelNotSafe.are_children_leaf_nodes">
<span class="sig-name descname"><span class="pre">are_children_leaf_nodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">children</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTreeParallelNotSafe.are_children_leaf_nodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTreeParallelNotSafe.are_children_leaf_nodes" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTreeParallelNotSafe.bound">
<span class="sig-name descname"><span class="pre">bound</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scores</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTreeParallelNotSafe.bound"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTreeParallelNotSafe.bound" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTreeParallelNotSafe.branch">
<span class="sig-name descname"><span class="pre">branch</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTreeParallelNotSafe.branch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTreeParallelNotSafe.branch" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTreeParallelNotSafe.branch_and_bound">
<span class="sig-name descname"><span class="pre">branch_and_bound</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTreeParallelNotSafe.branch_and_bound"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTreeParallelNotSafe.branch_and_bound" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTreeParallelNotSafe.clone_hiddens">
<span class="sig-name descname"><span class="pre">clone_hiddens</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTreeParallelNotSafe.clone_hiddens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTreeParallelNotSafe.clone_hiddens" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTreeParallelNotSafe.concat_hiddens">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">concat_hiddens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hiddens</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTreeParallelNotSafe.concat_hiddens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTreeParallelNotSafe.concat_hiddens" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTreeParallelNotSafe.get_children">
<span class="sig-name descname"><span class="pre">get_children</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_probs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_nlps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTreeParallelNotSafe.get_children"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTreeParallelNotSafe.get_children" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTreeParallelNotSafe.get_log_probabilities">
<span class="sig-name descname"><span class="pre">get_log_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seqs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTreeParallelNotSafe.get_log_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTreeParallelNotSafe.get_log_probabilities" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTreeParallelNotSafe.get_seq_idx">
<span class="sig-name descname"><span class="pre">get_seq_idx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_probs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTreeParallelNotSafe.get_seq_idx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTreeParallelNotSafe.get_seq_idx" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTreeParallelNotSafe.initialize_root_node">
<span class="sig-name descname"><span class="pre">initialize_root_node</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTreeParallelNotSafe.initialize_root_node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTreeParallelNotSafe.initialize_root_node" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTreeParallelNotSafe.purge_queue">
<span class="sig-name descname"><span class="pre">purge_queue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">downto</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTreeParallelNotSafe.purge_queue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTreeParallelNotSafe.purge_queue" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTreeParallelNotSafe.return_leaf_node">
<span class="sig-name descname"><span class="pre">return_leaf_node</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTreeParallelNotSafe.return_leaf_node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTreeParallelNotSafe.return_leaf_node" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTreeParallelNotSafe.select_all_hiddens">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">select_all_hiddens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hiddens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idxs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTreeParallelNotSafe.select_all_hiddens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTreeParallelNotSafe.select_all_hiddens" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTreeParallelNotSafe.select_hiddens">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">select_hiddens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hiddens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">move_to_device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTreeParallelNotSafe.select_hiddens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTreeParallelNotSafe.select_hiddens" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="desmiles.decoding.astar.AstarTreeParallelNotSafe.sort_scores">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">sort_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_branches</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#AstarTreeParallelNotSafe.sort_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.AstarTreeParallelNotSafe.sort_scores" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="desmiles.decoding.astar.getChildren">
<span class="sig-prename descclassname"><span class="pre">desmiles.decoding.astar.</span></span><span class="sig-name descname"><span class="pre">getChildren</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#getChildren"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.getChildren" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="desmiles.decoding.astar.get_astar_tree">
<span class="sig-prename descclassname"><span class="pre">desmiles.decoding.astar.</span></span><span class="sig-name descname"><span class="pre">get_astar_tree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isLeafNode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_branches</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#get_astar_tree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.get_astar_tree" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="desmiles.decoding.astar.left_pad_to_right_pad">
<span class="sig-prename descclassname"><span class="pre">desmiles.decoding.astar.</span></span><span class="sig-name descname"><span class="pre">left_pad_to_right_pad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seqs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#left_pad_to_right_pad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.left_pad_to_right_pad" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="desmiles.decoding.astar.purgedQueue">
<span class="sig-prename descclassname"><span class="pre">desmiles.decoding.astar.</span></span><span class="sig-name descname"><span class="pre">purgedQueue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downto</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/astar.html#purgedQueue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.astar.purgedQueue" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<span class="target" id="module-desmiles.decoding.greedy"></span><dl class="py function">
<dt class="sig sig-object py" id="desmiles.decoding.greedy.beam_search">
<span class="sig-prename descclassname"><span class="pre">desmiles.decoding.greedy.</span></span><span class="sig-name descname"><span class="pre">beam_search</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rnn_desmiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beam_sz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_tokens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/decoding/greedy.html#beam_search"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.decoding.greedy.beam_search" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-desmiles.utils">
<span id="desmiles-utils"></span><h3>desmiles.utils<a class="headerlink" href="#module-desmiles.utils" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="desmiles.utils.accuracy4">
<span class="sig-prename descclassname"><span class="pre">desmiles.utils.</span></span><span class="sig-name descname"><span class="pre">accuracy4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/utils.html#accuracy4"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.utils.accuracy4" title="Permalink to this definition"></a></dt>
<dd><p>Compute accuracy with <cite>targs</cite> when <cite>input</cite> is bs * n_classes, excluding tokens 0–3.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="desmiles.utils.decoder">
<span class="sig-prename descclassname"><span class="pre">desmiles.utils.</span></span><span class="sig-name descname"><span class="pre">decoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx_vec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itos</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/utils.html#decoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.utils.decoder" title="Permalink to this definition"></a></dt>
<dd><p>Return a SMILES string from an index vector (deals with reversal)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="desmiles.utils.get_default_decoder">
<span class="sig-prename descclassname"><span class="pre">desmiles.utils.</span></span><span class="sig-name descname"><span class="pre">get_default_decoder</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/utils.html#get_default_decoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.utils.get_default_decoder" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="desmiles.utils.image_of_mols">
<span class="sig-prename descclassname"><span class="pre">desmiles.utils.</span></span><span class="sig-name descname"><span class="pre">image_of_mols</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">molsPerRow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subImgSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(200,</span> <span class="pre">200)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/utils.html#image_of_mols"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.utils.image_of_mols" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="desmiles.utils.load_old_pretrained_desmiles">
<span class="sig-prename descclassname"><span class="pre">desmiles.utils.</span></span><span class="sig-name descname"><span class="pre">load_old_pretrained_desmiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_learner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_rnn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp_emb_sz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emb_sz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itos_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/workspace/DESMILES-test/data/pretrained/id.dec8000'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/utils.html#load_old_pretrained_desmiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.utils.load_old_pretrained_desmiles" title="Permalink to this definition"></a></dt>
<dd><p>Load a DESMILES model whose weights were generated in pytorch 0.4</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="desmiles.utils.load_pretrained_desmiles">
<span class="sig-prename descclassname"><span class="pre">desmiles.utils.</span></span><span class="sig-name descname"><span class="pre">load_pretrained_desmiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_learner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_rnn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp_emb_sz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emb_sz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itos_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/workspace/DESMILES-test/data/pretrained/id.dec8000'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_opt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/utils.html#load_pretrained_desmiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.utils.load_pretrained_desmiles" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="desmiles.utils.process_smiles">
<span class="sig-prename descclassname"><span class="pre">desmiles.utils.</span></span><span class="sig-name descname"><span class="pre">process_smiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sm</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/utils.html#process_smiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.utils.process_smiles" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="desmiles.utils.smiles_idx_to_string">
<span class="sig-prename descclassname"><span class="pre">desmiles.utils.</span></span><span class="sig-name descname"><span class="pre">smiles_idx_to_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/utils.html#smiles_idx_to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.utils.smiles_idx_to_string" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="desmiles.utils.smiles_to_fingerprint">
<span class="sig-prename descclassname"><span class="pre">desmiles.utils.</span></span><span class="sig-name descname"><span class="pre">smiles_to_fingerprint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles_str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sparse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_tensor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/desmiles/utils.html#smiles_to_fingerprint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#desmiles.utils.smiles_to_fingerprint" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="desmiles" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="release-notes.html" class="btn btn-neutral float-right" title="Release notes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018, 2019, 2020, D. E. Shaw Research.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>